# _*_ coding: utf-8 _*_
# @Time : 2025/6/16 0016 21:25
# @Author : 韦丽
# @Version: V 1.0
# @File : ComplexLayoutPDF.py
# @desc : reportlab制作PDF文件
import datetime

from reportlab.lib import colors, enums
from reportlab.lib.pagesizes import A4
from reportlab.lib.styles import getSampleStyleSheet, ParagraphStyle
from reportlab.lib.units import cm
from reportlab.pdfbase import pdfmetrics
from reportlab.pdfbase.ttfonts import TTFont
from reportlab.platypus import (
    BaseDocTemplate, Frame, Paragraph, PageTemplate,
    Image, Table, TableStyle, Spacer, PageBreak
)
import os

# 注册中文字体（解决中文显示问题）:ml-citation{ref="9,11" data="citationList"}

current_dir = os.path.dirname(os.path.abspath(__file__))
font_path = os.path.join(current_dir, 'SimSun.ttf')
pdfmetrics.registerFont(TTFont('SimSun', font_path))

class ComplexLayoutPDF:
    def __init__(self, pngFile, pageReportName, pageTitle, filename, passKey, pdfData: dict = {}):
        self.pageTitle = pageTitle
        self.filename = filename
        self.passKey = passKey
        self.pdfData = pdfData
        self.pageReportName = pageReportName
        self.pngFile = pngFile
        self.page_width, self.page_height = A4
        self.styles = getSampleStyleSheet()
        self._setup_custom_styles()

    def _setup_custom_styles(self):
        # 创建自定义样式（含中文字体支持）:ml-citation{ref="9,11" data="citationList"}
        self.styles.add(ParagraphStyle(
            name='ChineseNormal',
            fontName='SimSun',
            fontSize=10,
            leading=14,
            textColor=colors.red,
            alignment=enums.TA_LEFT,
            spaceAfter=6
        ))
        self.styles.add(ParagraphStyle(
            name='SidebarHeading',
            fontName='SimSun',
            fontSize=12,
            textColor=colors.darkblue,
            spaceAfter=5,
            leading=14
        ))

    def _create_page_templates(self):
        # 定义主内容框架（左栏）:ml-citation{ref="3,8" data="citationList"}
        left_frame = Frame(
            x1=1 * cm, y1=5 * cm,
            width=18 * cm, height=22 * cm,
            leftPadding=0, bottomPadding=0,
            rightPadding=0.5 * cm, topPadding=0,
            id='left_col'
        )

        # 定义侧边栏框架（右栏）:ml-citation{ref="3" data="citationList"}
        right_frame = Frame(
            x1=12 * cm, y1=5 * cm,
            width=6 * cm, height=22 * cm,
            leftPadding=0, bottomPadding=0,
            rightPadding=0, topPadding=0,
            id='right_col'
        )

        # 创建页眉函数（带页码）:ml-citation{ref="11" data="citationList"}
        def header(canvas, doc):
            canvas.saveState()
            # 顶部横幅（跨栏）:ml-citation{ref="12" data="citationList"}
            canvas.setFillColor(colors.lightblue)
            canvas.rect(0, self.page_height - 3 * cm, self.page_width, 3 * cm, stroke=0, fill=1)
            # 主标题
            canvas.setFont('SimSun', 16)
            canvas.setFillColor(colors.blue)
            canvas.drawCentredString(self.page_width / 2, self.page_height - 2 * cm, f"{self.pageReportName}")
            # 页码
            canvas.setFont('SimSun', 10)
            canvas.drawRightString(self.page_width - 1 * cm, self.page_height - 2.5 * cm,
                                   f"{datetime.date.today().strftime('%Y年%m月%d日')} 第 {doc.page} 页")
            canvas.restoreState()

        # 创建页脚函数:ml-citation{ref="11" data="citationList"}
        def footer(canvas, doc):
            canvas.saveState()
            # 风险种类说明
            canvas.setFont('SimSun', 10)
            canvas.setFillColor(colors.red)
            text = f"触：触发风险 禁：近期解禁 案：立案调查 频：频发风险 退：退市风险 誉：商誉风险"
            text_width = canvas.stringWidth(text)
            canvas.drawCentredString(1 * cm + text_width / 2, 4.5* cm, text)

            # canvas.setFont('SimSun', 10)
            # canvas.setFillColor(colors.blue)
            # text = f"注意：入市须谨慎，不做任何投资建议！！！"
            # text_width = canvas.stringWidth(text)
            # canvas.drawCentredString(2 * cm + text_width / 2, 4 * cm, text)

            # canvas.setFont('SimSun', 10)
            # canvas.setFillColor(colors.red)
            # text = f"誉：商誉风险"
            # text_width = canvas.stringWidth(text)
            # canvas.drawCentredString(3 * cm, 3.5 * cm, text)
            #
            # canvas.setFont('SimSun', 10)
            # canvas.setFillColor(colors.red)
            # text = f"触：触发风险"
            # text_width = canvas.stringWidth(text)
            # canvas.drawCentredString(3 * cm, 3 * cm, text)
            #
            # canvas.setFont('SimSun', 10)
            # canvas.setFillColor(colors.red)
            # text = f"退：退市风险"
            # text_width = canvas.stringWidth(text)
            # canvas.drawCentredString(3 * cm, 2.5 * cm, text)
            #
            # canvas.setFont('SimSun', 10)
            # canvas.setFillColor(colors.red)
            # text = f"禁：近期解禁"
            # text_width = canvas.stringWidth(text)
            # canvas.drawCentredString(3 * cm, 2 * cm, text)

            # 公司名称
            canvas.setFont('SimSun', 10)
            canvas.setFillColor(colors.grey)
            canvas.drawCentredString(self.page_width / 2, 1 * cm,
                                     "")
            # canvas.drawCentredString(self.page_width / 2, 1 * cm,
            #                          "© 2025 理斯堡科技有限公司 ")
            canvas.restoreState()

        # 构建页面模板（双栏+页眉页脚）:ml-citation{ref="3,8" data="citationList"}
        return [
            PageTemplate(
                id='TwoColumn',
                frames=[left_frame, right_frame],
                onPage=header,
                onPageEnd=footer
            )
        ]

    def build_document(self):

        # 创建文档模板:ml-citation{ref="8" data="citationList"}
        doc = BaseDocTemplate(
            self.filename,
            pagesize=A4,
            leftMargin=0,
            rightMargin=0
        )
        doc.addPageTemplates(self._create_page_templates())

        # 生成内容流（混合文本、表格、图片）:ml-citation{ref="4,5" data="citationList"}
        self.story = []

        self.pdfHeight = [12, 34]

        # 第一页排版
        if self.passKey == 'WLW':
            self.pageCount = self.pdfHeight[1]
        else:
            self.pageCount = self.pdfHeight[0]
            # 第一页内容
            self.story.append(Spacer(1, 0.5 * cm, True))
            self.story.append(Paragraph(f"", self.styles['ChineseNormal']))
            self.story.append(Spacer(1, 0.5 * cm))

            # 左侧主栏：长文本段落:ml-citation{ref="3" data="citationList"}
            self.story.append(Paragraph(f"{self.pageTitle}", self.styles['SidebarHeading']))
            self.story.append(Image(self.pngFile, width=17.9 * cm, height=12 * cm, hAlign='LEFT'))

        # 数据排版
        if self.pdfData:
            for sshy, values in enumerate(self.pdfData):
                listSize = len(self.pdfData[values])
                # WLW时，出力涨停在2件以上的数据
                if self.passKey == 'WLW':
                    if listSize == 2:
                        continue

                self.nextPageEdit(values)

        # 生成文档
        doc.build(self.story)

    # 下一页页面编辑
    def nextPageEdit(self, keyName):
        self.story.append(Spacer(1, 0.5 * cm))
        # 行业名称赋值
        self.story.append(Paragraph(f"☆ {keyName}", self.styles['SidebarHeading']))
        if self.pageCount in [0, 1, 2, 3]:
            # self.story.append(Spacer(1, 0.5 * cm))
            # # 行业名称赋值
            # self.story.append(Paragraph(f"☆ {keyName}", self.styles['SidebarHeading']))
            # 下一页
            self.story.append(PageBreak())
            # 页面总数 = Next页面总数
            self.pageCount = self.pdfHeight[1]
            self.story.append(Spacer(1, 0.5 * cm))
            # 页面总数-1
            self.pageCount -= 1
        else:
            # self.story.append(Spacer(1, 0.5 * cm))
            # # 行业名称赋值
            # self.story.append(Paragraph(f"☆ {keyName}", self.styles['SidebarHeading']))
            # 页面总数-2
            self.pageCount -= 2

        # 表格数据编辑
        self.tableDataEdit(keyName)

    # 表格数据编辑
    def tableDataEdit(self, keyName):
        # 表格宽度设定
        table_widt = [2.2 * cm, 1.8 * cm, 2 * cm, 2.1 * cm, 2.5 * cm, 2.2 * cm, 2.4 * cm, 2.6 * cm]
        start = 0
        sshyData = self.pdfData[keyName]
        listSize = len(sshyData)
        while True:
            # 表格样式设定
            table_style = [
                ('FONTNAME', (0, 0), (-1, 0), 'SimSun'),  # 表头字体
                ('FONTNAME', (0, 1), (-1, -1), 'SimSun'),  # 表格体字体 ⭐关键⭐
                ('FONTSIZE', (0, 0), (-1, 0), 10),  # 表头字号
                ('GRID', (0, 0), (-1, -1), 0.5, colors.grey),
                ('VALIGN', (0, 0), (-1, -1), 'MIDDLE'),
            ]
            end = listSize if self.pageCount >= listSize else self.pageCount
            tableData = sshyData[start: start + end]
            # 跨栏表格（跨越左右两栏）:ml-citation{ref="8" data="citationList"}
            table = Table(
                tableData,
                colWidths=table_widt,
                repeatRows=0
            )
            rowNo = 0
            rangeIndex = 0
            if start == 0:
                # 表标题样式
                table_style.append(('BACKGROUND', (0, 0), (-1, 0), colors.lightblue))
                rowNo = 1
                rangeIndex = 1

            # 风险种类不是正常的数据标红
            for index in range(rangeIndex, len(tableData)):
                if not tableData[index][5] in ['无风险', '重']:
                    table_style.append(('TEXTCOLOR', (0, rowNo), (-1, rowNo), colors.red))
                rowNo += 1
            table.setStyle(TableStyle(table_style))
            self.story.append(table)
            self.pageCount -= end
            listSize -= end
            # 页面总数 == 0
            if self.pageCount == 0:
                # 下一页
                self.story.append(PageBreak())
                # 页面总数 = Next页面总数
                self.pageCount = self.pdfHeight[1]
                # 处理数据 > 0
                if listSize > 0:
                    self.story.append(Spacer(1, 0.5 * cm))
                    # 页面总数-1
                    self.pageCount -= 1
                    start += end
                elif listSize == 0:
                    break
            elif self.pageCount > 0:
                # 处理数据 > 0
                if listSize > 0:
                    # 下一页
                    self.story.append(PageBreak())
                    # 页面总数 = Next页面总数
                    self.pageCount = self.pdfHeight[1]
                    self.story.append(Spacer(1, 0.5 * cm))
                    # 页面总数 = Next页面总数
                    self.pageCount -= 1
                    start += end
                elif listSize == 0:
                    break

# 使用示例
if __name__ == "__main__":
    pdfData =  {'农药兽药一共有 7件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/17', '000525', '红太阳    ', '9.03', ' 首板/12', '无风险', '16.46', '14:33:36'], ['2025/06/17', '002391', '长青股份   ', '6.6', ' 首板/0', '无风险', '18.04', '14:49:33'], ['2025/06/17', '002513', '蓝丰生化   ', '5.84', ' 首板/0', '频', '6.7', '09:36:27'], ['2025/06/16', '002734', '利民股份   ', '22.7', ' 首板/0', '无风险', '31.18', '14:52:09'], ['2025/06/16', '603086', '先达股份   ', '10.08', ' 首板/0', '触', '11.45', '09:56:32'], ['2025/06/16', '603585', '苏利股份   ', '21.84', ' 首板/0', '无风险', '10.28', '13:02:40'], ['2025/06/17', '603585', '苏利股份   ', '24.02', '2连板/12', '无风险', '16.8', '14:46:41']], '电子元件一共有 5件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/18', '002579', '中京电子   ', '9.01', ' 首板/1', '触', '11.18', '10:16:18'], ['2025/06/18', '300903', '科翔股份   ', '10.63', ' 首板/0', '无风险', '31.73', '14:03:33'], ['2025/06/18', '301176', '逸豪新材   ', '21.23', ' 首板/1', '无风险', '30.4', '10:24:48'], ['2025/06/17', '600478', '科力远    ', '5.52', ' 首板/0', '无风险', '8.15', '11:11:06'], ['2025/06/18', '688496', '清越科技   ', '9.58', ' 首板/5', '触', '12.19', '14:19:17']], '物流行业一共有 5件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/17', '001331', '胜通能源   ', '10.74', ' 首板/2', '频', '30.39', '13:11:15'], ['2025/06/17', '002492', '恒基达鑫   ', '6.89', ' 首板/1', '无风险', '16.25', '14:05:18'], ['2025/06/18', '002769', '普路通    ', '9.3', ' 首板/0', '无风险', '9.48', '13:08:54'], ['2025/06/17', '002800', '天顺股份   ', '14.47', ' 首板/0', '案', '15.02', '14:49:45'], ['2025/06/17', '002930', '宏川智慧   ', '11.66', ' 首板/0', '誉', '4.35', '13:16:30']], '化学制药一共有 4件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/16', '000788', '北大医药   ', '6.58', ' 首板/1', '无风险', '7.65', '09:55:30'], ['2025/06/17', '300016', '北陆药业   ', '10.43', ' 首板/0', '无风险', '17.29', '09:42:42'], ['2025/06/18', '601089', '福元医药   ', '18.76', ' 首板/0', '无风险', '6.99', '10:11:13'], ['2025/06/17', '603222', '济民健康   ', '6.88', ' 首板/0', '案,触', '2.74', '09:35:57']], '电源设备一共有 4件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/17', '002366', '融发核电   ', '8.46', ' 首板/2', '案', '32.5', '10:54:54'], ['2025/06/16', '002951', '金时科技   ', '15.36', '2连板/0', '无风险', '9.69', '13:25:09'], ['2025/06/17', '600405', '动力源    ', '5.15', ' 首板/0', '频', '12.44', '13:06:17'], ['2025/06/17', '600475', '华光环能   ', '11.48', ' 首板/0', '无风险', '2.93', '14:05:15']], '通信设备一共有 7件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/16', '002017', '东信和平   ', '13.27', ' 首板/1', '无风险', '7.65', '09:32:57'], ['2025/06/17', '002017', '东信和平   ', '14.6', '2连板/9', '无风险', '28.36', '15:00:00'], ['2025/06/18', '002017', '东信和平   ', '16.06', '3连板/2', '无风险', '24.42', '13:41:57'], ['2025/06/16', '002104', '恒宝股份   ', '13.45', ' 首板/15', '案', '44.62', '13:28:45'], ['2025/06/17', '002104', '恒宝股份   ', '14.71', '2连板/0', '案', '38.07', '11:00:27'], ['2025/06/18', '003040', '楚天龙    ', '20.02', ' 首板/2', '无风险', '16.81', '10:58:33'], ['2025/06/17', '600775', '南京熊猫   ', '10.65', ' 首板/0', '无风险', '4.82', '09:30:01']], '化学原料一共有 6件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/18', '002109', '兴化股份   ', '4.22', ' 首板/0', '无风险', '5.64', '09:44:45'], ['2025/06/16', '600610', '中毅达    ', '14.63', ' 首板/0', '誉,频', '13.61', '14:48:38'], ['2025/06/16', '600714', '金瑞矿业   ', '13.23', '2连板/4', '触', '24.31', '14:55:20'], ['2025/06/16', '600722', '金牛化工   ', '6.34', '2连板/0', '无风险', '1.07', '09:25:00'], ['2025/06/17', '600722', '金牛化工   ', '6.97', '3连板/3', '无风险', '14.68', '09:35:46'], ['2025/06/18', '600722', '金牛化工   ', '7.67', '4连板/0', '无风险', '6.52', '09:25:01']], '专用设备一共有 6件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/16', '002490', '山东墨龙   ', '4.79', '2连板/0', '频', '1.28', '09:25:00'], ['2025/06/17', '002490', '山东墨龙   ', '5.27', '3连板/7', '频', '28.93', '14:56:51'], ['2025/06/18', '002490', '山东墨龙   ', '5.8', '4连板/4', '频', '21.24', '10:26:21'], ['2025/06/16', '003036', '泰坦股份   ', '13.7', ' 首板/0', '无风险', '3.33', '10:18:57'], ['2025/06/18', '600302', '标准股份   ', '6.53', ' 首板/1', '触', '7.72', '09:36:51'], ['2025/06/18', '601606', '长城军工   ', '15.17', ' 首板/0', '触', '8.33', '09:47:27']], '互联网服一共有 4件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/16', '002115', '三维通信   ', '9.0', ' 首板/1', '触', '19.13', '10:02:33'], ['2025/06/16', '002291', '遥望科技   ', '7.18', ' 首板/0', '触', '12.99', '10:23:30'], ['2025/06/18', '300269', '联建光电   ', '5.0', ' 首板/3', '频', '29.75', '11:07:09'], ['2025/06/16', '300872', '天阳科技   ', '22.68', ' 首板/4', '触', '35.45', '13:41:51']], '家用轻工一共有 4件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/16', '002348', '高乐股份   ', '4.26', ' 首板/5', '触', '18.17', '11:26:30'], ['2025/06/16', '002678', '珠江钢琴   ', '5.6', ' 首板/1', '触', '5.1', '10:52:33'], ['2025/06/17', '002678', '珠江钢琴   ', '6.16', '2连板/0', '触', '2.27', '09:30:06'], ['2025/06/17', '002899', '英派斯    ', '23.0', ' 首板/1', '无风险', '8.06', '14:09:51']], '通用设备一共有 3件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/17', '000777', '中核科技   ', '21.78', ' 首板/0', '无风险', '6.54', '09:39:57'], ['2025/06/18', '002150', '通润装备   ', '11.75', ' 首板/0', '无风险', '4.99', '09:33:39'], ['2025/06/18', '600992', '贵绳股份   ', '14.88', ' 首板/0', '无风险', '9.03', '11:23:13']], '采掘行业一共有 7件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/16', '002207', '准油股份   ', '7.55', '2连板/0', '退,频', '2.27', '09:25:00'], ['2025/06/17', '002207', '准油股份   ', '8.31', '3连板/2', '退,频', '29.1', '10:07:54'], ['2025/06/18', '002207', '准油股份   ', '9.14', '4连板/0', '退,频', '1.5', '09:25:00'], ['2025/06/16', '002828', '贝肯能源   ', '11.1', '2连板/0', '无风险', '3.36', '09:25:00'], ['2025/06/17', '002828', '贝肯能源   ', '12.21', '3连板/1', '无风险', '55.26', '14:50:33'], ['2025/06/18', '002828', '贝肯能源   ', '13.43', '4连板/1', '无风险', '48.74', '14:28:57'], ['2025/06/16', '300164', '通源石油   ', '6.07', '2连板/0', '誉,触', '59.14', '15:00:00']], '家电行业一共有 3件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/18', '002676', '顺威股份   ', '6.19', ' 首板/2', '无风险', '6.2', '10:09:24'], ['2025/06/18', '603215', '比依股份   ', '21.14', ' 首板/1', '无风险', '15.05', '10:02:50'], ['2025/06/17', '603579', '荣泰健康   ', '23.74', ' 首板/0', '无风险', '6.24', '11:10:04']], '汽车零部一共有 3件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/16', '002537', '海联金汇   ', '8.56', ' 首板/1', '案', '12.9', '10:17:15'], ['2025/06/16', '002593', '日上集团   ', '5.19', ' 首板/0', '无风险', '14.85', '13:59:09'], ['2025/06/17', '600960', '渤海汽车   ', '5.05', ' 首板/0', '无风险', '0.27', '09:25:02']], '化纤行业一共有 2件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/18', '603332', '苏州龙杰   ', '18.34', ' 首板/4', '无风险', '18.97', '10:56:52'], ['2025/06/16', '688203', '海正生材   ', '15.54', ' 首板/0', '无风险', '16.33', '13:00:45']], '纺织服装一共有 2件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/17', '002780', '三夫户外   ', '14.01', ' 首板/0', '案', '11.28', '09:40:30'], ['2025/06/16', '603587', '地素时尚   ', '14.44', ' 首板/0', '无风险', '4.03', '10:47:05']], '文化传媒一共有 2件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/16', '300251', '光线传媒   ', '22.1', ' 首板/0', '无风险', '9.97', '10:56:57'], ['2025/06/18', '600551', '时代出版   ', '9.27', ' 首板/0', '无风险', '1.09', '09:25:02']], '软件开发一共有 2件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/16', '300682', '朗新集团   ', '20.47', ' 首板/0', '誉', '11.51', '13:38:36'], ['2025/06/16', '301197', '工大科雅   ', '22.19', ' 首板/0', '触', '20.53', '09:41:48']], '电池一共有 2件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/17', '300457', '赢合科技   ', '20.45', ' 首板/2', '案,触', '11.67', '10:56:12'], ['2025/06/18', '600110', '诺德股份   ', '4.25', '2连板/0', '案,频', '10.96', '14:08:23']], '多元金融一共有 2件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/16', '001236', '弘业期货   ', '11.0', ' 首板/0', '无风险', '9.37', '09:31:12'], ['2025/06/18', '603123', '翠微股份   ', '13.2', ' 首板/3', '无风险', '24.83', '14:41:49']], '装修建材一共有 1件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/17', '603610', '麒盛科技   ', '13.16', ' 首板/5', '无风险', '8.94', '09:37:57']], '航运港口一共有 1件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/17', '000520', '凤凰航运   ', '5.58', ' 首板/0', '触', '14.07', '10:57:51']], '综合行业一共有 2件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/17', '600113', '浙江东日   ', '15.85', ' 首板/5', '无风险', '3.73', '11:18:54'], ['2025/06/18', '600113', '浙江东日   ', '17.44', '2连板/0', '无风险', '5.35', '10:22:33']], '非金属材一共有 1件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/16', '001296', '长江材料   ', '20.32', ' 首板/0', '无风险', '18.36', '13:18:06']], '石油行业一共有 1件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/16', '000554', '泰山石油   ', '7.87', '2连板/2', '无风险', '16.69', '09:31:42']], '电网设备一共有 1件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/18', '002471', '中超控股   ', '5.54', ' 首板/4', '触', '22.65', '09:44:18']], '酿酒行业一共有 2件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/17', '600543', '莫高股份   ', '6.17', ' 首板/0', '案,退,触', '7.32', '10:06:10'], ['2025/06/18', '600543', '莫高股份   ', '6.79', '2连板/0', '案,退,触', '2.67', '09:25:01']], '煤炭行业一共有 1件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/16', '600792', '云煤能源   ', '4.06', '2连板/0', '触', '1.33', '09:25:03']], '电力行业一共有 3件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/16', '002015', '协鑫能科   ', '10.71', '2连板/1', '无风险', '3.57', '09:30:27'], ['2025/06/17', '002015', '协鑫能科   ', '11.78', '3连板/0', '无风险', '0.72', '09:25:00'], ['2025/06/18', '002015', '协鑫能科   ', '12.96', '4连板/0', '无风险', '5.86', '09:30:57']], '珠宝首饰一共有 1件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/16', '002731', '萃华珠宝   ', '17.28', '2连板/0', '无风险', '13.94', '09:40:27']], '环保行业一共有 1件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/16', '002887', '绿茵生态   ', '9.01', ' 首板/0', '无风险', '5.94', '09:31:03']], '中药一共有 1件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/16', '000590', '启迪药业   ', '10.19', ' 首板/0', '退,频', '6.75', '14:46:30']], '消费电子一共有 1件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/17', '002855', '捷荣技术   ', '18.43', ' 首板/0', '触', '2.76', '10:04:45']], '橡胶制品一共有 1件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/18', '300767', '震安科技   ', '12.78', ' 首板/0', '触', '12.36', '09:38:33']], '房地产开一共有 1件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/16', '002208', '合肥城建   ', '7.49', ' 首板/0', '无风险', '9.47', '11:18:54']], '小金属一共有 1件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/17', '600281', '华阳新材   ', '8.45', ' 首板/4', '频', '33.58', '14:53:55']], '半导体一共有 1件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/18', '002213', '大为股份   ', '18.12', ' 首板/0', '无风险', '24.23', '13:26:33']], '医疗服务一共有 1件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/17', '002173', '创新医疗   ', '12.64', ' 首板/0', '案', '5.8', '09:25:00']], '化学制品一共有 1件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/18', '002319', '乐通股份   ', '13.0', ' 首板/1', '触', '12.08', '14:53:15']], '农牧饲渔一共有 2件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/17', '603151', '邦基科技   ', '18.83', ' 首板/2', '无风险', '7.39', '09:42:31'], ['2025/06/18', '603151', '邦基科技   ', '20.71', '2连板/0', '无风险', '1.26', '09:25:02']], '光学光电一共有 2件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/17', '000020', '深华发Ａ   ', '13.78', ' 首板/0', '触', '5.13', '10:29:27'], ['2025/06/18', '000020', '深华发Ａ   ', '15.16', '2连板/2', '触', '14.89', '10:42:45']], '风电设备一共有 1件': [['交易日期', '股票No', '股票名称', '最新价(元)', '连板/炸板数', '风险种类', '换手率(%)', '最后封板时间'], ['2025/06/16', '300772', '运达股份   ', '12.72', ' 首板/9', '无风险', '13.65', '14:53:54']]}
    pageTitle = '★以所属行业排名'
    pdf_builder = ComplexLayoutPDF("dailyLimit_output.png", "涨停板情报", pageTitle, "complex_layout.pdf", '', pdfData)
    pdf_builder.build_document()
